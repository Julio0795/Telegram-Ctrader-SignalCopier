<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Activity Log</title>
    <style>
        :root {
            --bg-dark: #1e2128; --bg-medium: #282c34; --bg-light: #3a4049;
            --text-primary: #abb2bf; --text-secondary: #828997;
            --accent-blue: #61afef; --accent-green: #98c379; --accent-yellow: #e5c07b; --accent-red: #e06c75;
            --border-color: #4b5263;
        }
        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: var(--bg-dark); color: var(--text-primary); margin: 0; padding: 20px;
        }
        .container { max-width: 1200px; margin: auto; }
        h1 { color: var(--accent-blue); font-weight: 300; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; }
        .log-box {
            height: 80vh; overflow-y: scroll; border: 1px solid var(--border-color); padding: 10px;
            background-color: var(--bg-medium); border-radius: 8px; font-family: 'Consolas', 'Courier New', monospace;
            font-size: 14px; white-space: pre-wrap; box-shadow: inset 0 0 10px rgba(0,0,0,0.3);
        }
        .log-box p { margin: 0; padding: 6px 12px; border-bottom: 1px solid var(--bg-light); transition: background-color 0.2s; }
        .log-box p:hover { background-color: var(--bg-light); }
        a { color: var(--accent-blue); text-decoration: none; } a:hover { text-decoration: underline; }
        
        .log-INFO { color: var(--text-secondary); }
        .log-SUCCESS { color: var(--accent-green); }
        .log-WARN { color: var(--accent-yellow); }
        .log-ERROR { color: var(--accent-red); font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Detailed Activity Log</h1>
        <p><a href="/">&larr; Back to Main Dashboard</a></p>
        <div class="log-box" id="log-box"><p>Loading logs...</p></div>
    </div>
    <script>
        function updateLog() {
            fetch('/get_state').then(response => response.json()).then(data => {
                const logBox = document.getElementById('log-box');
                const newLogHtml = data.activity_log.map(log => {
                    const time = new Date(log.timestamp).toLocaleTimeString();
                    return `<p class="log-${log.level}"><span style="color: #666;">[${time}]</span> [${log.level}] ${log.message}</p>`;
                }).join('');
                if (logBox.innerHTML !== newLogHtml) {
                    logBox.innerHTML = newLogHtml;
                }
            }).catch(error => { logBox.innerHTML = '<p class="log-ERROR">Error connecting to backend...</p>'; });
        }
        setInterval(updateLog, 2000);
        document.addEventListener('DOMContentLoaded', updateLog);
    </script>
</body>
</html>